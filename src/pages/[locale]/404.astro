---
import { datocmsRequest } from '@lib/datocms';
import type { NotFoundPageQuery, NotFoundPageRecord } from '@lib/types/datocms.d.ts';
import query from './404.query.graphql';
import Layout from '@layouts/Default.astro';
import Blocks from '@blocks/Blocks.astro';
import type { AnyBlock } from '@blocks/Blocks';
import { locales } from '@lib/i18n';
import { noIndexTag, titleTag } from '@lib/seo';

export async function getStaticPaths() {
  return locales.map(locale => ({
    params: { locale }
  }));
}

const { locale } = Astro.params;
const { page } = await datocmsRequest<NotFoundPageQuery>({ query, variables: { locale } }) as { page: NotFoundPageRecord };
---
<Layout
  pageUrls={[]}
  seoMetaTags={[ noIndexTag, titleTag(page.title) ]}
>
  <h1>{ page.title }</h1>
  <Blocks blocks={page.bodyBlocks as AnyBlock[]} />
</Layout>
