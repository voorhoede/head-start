---
import { datocmsRequest } from '../../lib/datocms';
import type { HomeQuery, HomePathsQuery } from '../../lib/datocms.d.ts';
import homeQuery from './index.query.graphql';
import homePathsQuery from './paths.query.graphql';
import Layout from '../../layouts/Default.astro';
import { setLocale, t } from '../../lib/i18n';

export async function getStaticPaths() {
  const data = await datocmsRequest<HomePathsQuery>({ query: homePathsQuery });

  return data.home.titles.map(title => ({
    params: { locale: title.locale }
  }));
}

const locale = setLocale(Astro.params.locale);
const { home } = await datocmsRequest<HomeQuery>({ query: homeQuery, variables: { locale } });
---
<Layout seoMetaTags={home._seoMetaTags}>
  <h1>{home.title}</h1>
  { t('share_on_social') }
</Layout>
