---
import type { ImageBlockFragment } from '../../lib/types/datocms';

interface Props {
  block: ImageBlockFragment
}

const { block } = Astro.props;
const { image } = block;
const altText = image.alt ? image.alt : ""; // default to empty string for accessibility
const isVectorImage = image.format === 'svg';
---

<figure>
  {
    isVectorImage
    ? <img 
        alt={ altText }
        loading="lazy"
        src={ image.url } 
      />
    : <img
        alt={ altText }
        loading="lazy"
        sizes={ image.responsiveImage.sizes }
        srcSet={ image.responsiveImage.srcSet }
        src={ image.responsiveImage.src }
        style={{
          aspectRatio: image.responsiveImage.aspectRatio,
          backgroundColor: image.responsiveImage.bgColor,
          backgroundImage: `url(${image.responsiveImage.base64})`
        }}
      />
  }
  { image.title && (
    <figcaption>
      { image.title }
    </figcaption>
  )}
</figure>

<style>
img {
  display: block;
  width: 100%;
  background-size: cover;
}
</style>
